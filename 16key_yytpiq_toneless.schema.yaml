# Rime schema
# encoding: utf-8

schema:
  schema_id: 16key_yytpiq_toneless
  name: "16鍵三橛粵拼（無聲調）"
  version: "3.1.5"
  author:
    - 基於 jyutping (https://github.com/rime/rime-jyutping)
  description:
    - ba do gu zi    bdgz ao ui
    - pv tu km cp    ptkc vu mp
    - me nr qn st    mnqs er nt
    - fi ly hq yk    flhy iy qk
    -
    - g-gw k-kw (c-j) (s-x) y-w

switches:
  - name: ascii_mode
    reset: 0
    states: [ "中文", "西文" ]
  - name: full_shape
    states: [ "半角", "全角" ]
  - name: simplification
    states: [ "漢字", "汉字" ]
  - name: ascii_punct
    states: [ "。，", "．，" ]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - reverse_lookup_translator
  filters:
    - simplifier
    - uniquifier

speller:
  alphabet: '1234567890abcdefghijklmnopqrstuvwxyz'
  delimiter: " '"
  algebra:
    - xform ng q
    - xform j Y
    - xform yu y
    - xform oe r
    - xform eoi ue
    - xform eo u
    - xform aa A
    - xform a v
    - xlit YA ya
    - abbrev/^([a-z]).+$/$1/
    - abbrev/^([gk]w).+$/$1/

    - xform/ue$/uu/ # -ue -uu

    - xform/^b/B/
    - xform/^p/P/
    - xform/^m/M/
    - xform/^f/F/
    - xform/^d/D/
    - xform/^t/T/
    - xform/^n/N/
    - xform/^l/L/
    - xform/^g/G/
    - xform/^k/K/
    - xform/^q/Q/
    - xform/^h/H/
    - xform/^z/Z/
    - xform/^c/C/
    - xform/^s/S/
    - xform/^y/Y/ # yi Yi, yy Yy
    - xform/w/W/

    - xform/(?<=[aveioury])u$/G/
    - xform/(?<=[aveiouryh])m$/K/
    - xform/(?<=[aveioury])n$/Q/
    - xform/(?<=[aveiouryh])q$/H/
    - xform/(?<=[aveioury])i$/Z/ # yi Yi Yi, yy Yy Yy
    - xform/(?<=[aveioury])p$/C/
    - xform/(?<=[aveioury])t$/S/
    - xform/(?<=[aveioury])k$/Y/

    - xform a B
    - xform v P
    - xform e M
    - xform i F # yi Yi Yi YF
    - xform o D
    - xform u T
    - xform r N
    - xform y L # yy Yy Yy YL

    - xform GW GG
    - xform KW KK
    - xform W YY

    - xlit ABCDEFGHIJKLMNOPQRSTUVWXYZ abcdefghijklmnopqrstuvwxyz

translator:
  dictionary: jyutping
  prism: 16key_yytpiq_toneless
  spelling_hints: 10
  preedit_format:
    - xlit abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ

    - xform/B(?=[GKQHZCSY])/a/
    - xform/P(?=[GKQHZCSY])/v/
    - xform/M(?=[GKQHZCSY])/e/
    - xform/F(?=[GKQHZCSY])/i/
    - xform/D(?=[GKQHZCSY])/o/ # "DG" "oG" ("ou")
    - xform/T(?=[GKQHZCSY])/u/
    - xform/N(?=[GKQHZCSY])/r/
    - xform/L(?=[GKQHZCSY])/y/

    - xform/(?<=^|[ '])B/b/
    - xform/(?<=^|[ '])P/p/
    - xform/(?<=^|[ '])M/m/
    - xform/(?<=^|[ '])F/f/
    - xform/(?<=^|[ '])D/d/ # " DDG" " dDG" (" dDq" " doq")
    - xform/(?<=^|[ '])T/t/
    - xform/(?<=^|[ '])N/n/
    - xform/(?<=^|[ '])L/l/
    - xform/(?<=^|[ '])G/g/
    - xform/(?<=^|[ '])K/k/
    - xform/(?<=^|[ '])Q/q/
    - xform/(?<=^|[ '])H/h/
    - xform/(?<=^|[ '])Z/z/
    - xform/(?<=^|[ '])C/c/
    - xform/(?<=^|[ '])S/s/
    - xform/(?<=^|[ '])Y/y/
    - xform gG gw
    - xform kK kw
    - xform yY w

    - xform G u
    - xform K m
    - xform Q n
    - xform H q
    - xform Z i
    - xform C p
    - xform S t
    - xform Y k

    - xform B a
    - xform P v
    - xform M e
    - xform F i
    - xform D o
    - xform T u
    - xform N r
    - xform L y

    - xform uu ue # -ue -uu
  comment_format:
    - xform ng q
    - xform j Y
    - xform yu y
    - xform oe r
    - xform eoi ue
    - xform eo u
    - xform aa A
    - xform a v
    - xlit YA ya

reverse_lookup:
  dictionary: terra_pinyin
  prism: 9key_terra_pinyin
  prefix: "`"
  suffix: "'"
  tips: 〔拼音〕
  preedit_format:
    - xform/([nl])v/$1ü/
    - xform/([nl])ue/$1üe/
    - xform/([jqxy])v/$1u/
  comment_format:
    - xform ng q
    - xform j Y
    - xform yu y
    - xform oe r
    - xform eoi ue
    - xform eo u
    - xform aa A
    - xform a v
    - xlit YA ya

punctuator:
  import_preset: default

key_binder:
  # enable paging with .,
  import_preset: default

recognizer:
  import_preset: default
  patterns:
    reverse_lookup: "`[1-9a-z]*'?$"
